(this["webpackJsonpchat-room"]=this["webpackJsonpchat-room"]||[]).push([[0],{229:function(e,t,a){e.exports=a(464)},234:function(e,t,a){},464:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(66),l=a.n(s),c=(a(234),a(9)),i=a(10),o=a(13),m=a(12),u=a(7),d=a(33),h=a(11),f=a(95),g=a(26),E=a.n(g),p=a(3),b=function(e,t,a,n){return function(r,s,l){l.getFirebase;var c=(0,l.getFirestore)(),i=s().firebase.profile,o=s().firebase.auth.uid,m=i.firstName+" "+i.lastName,u=e.friendId,d=e.Friend_Fullname;e.New_message=!0,c.collection("rooms").doc(o).collection("messages").doc(d).collection("details").add(Object(p.a)(Object(p.a)(Object(p.a)(Object(p.a)(Object(p.a)({},e),t),a),n),{},{friendFirstName:i.firstName,friendLastName:i.lastName,userId:o,CreatedAt:new Date})).then((function(){r({type:"ADD_DETAIL",message:e})})).catch((function(e){r({type:"ADD_DETAIL_ERROR",err:e})})),e.Friend_Fullname=m,e.friendId=o,c.collection("rooms").doc(u).collection("messages").doc(m).collection("details").add(Object(p.a)(Object(p.a)(Object(p.a)(Object(p.a)(Object(p.a)({},e),t),a),n),{},{friendFirstName:d,friendLastName:"",userId:u,CreatedAt:new Date})).then((function(){r({type:"ADD_DETAIL",message:e})})).catch((function(e){r({type:"ADD_DETAIL_ERROR",err:e})}))}},N=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={message:"",Friend_Fullname:"",secondmessage:"",friendId:"",New_message:!1},e.handleSubmit=function(t){t.preventDefault(),e.setState({message:e.state.message,Friend_Fullname:e.state.Friend_Fullname,secondmessage:e.state.secondmessage,friendId:e.state.friendId,New_message:e.state.New_message}),e.props.addMessages(e.state),e.props.addDetails(e.state)},e}return Object(i.a)(a,[{key:"render",value:function(){this.state.message="Say Hi to your new friend ",this.state.Friend_Fullname=this.props.name,this.state.secondmessage="Say Hi to your new friend ";for(var e=this.props,t=e.username,a=e.lenght,n=0;n<a;n++){var s=t?t[n].firstName+" "+t[n].lastName:null,l=t?t[n].friendId:null;s==this.props.name&&(this.state.friendId=l)}return r.a.createElement("div",{className:"card z-depth-0"},r.a.createElement("div",{className:"card-content grey-text text-darken-3"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"input-field"},r.a.createElement("span",{className:"card-title"},this.props.name),r.a.createElement("button",{className:"btn orange lighten-1 z-depth-0 right"},"Send Request")))))}}]),a}(n.Component),v=Object(h.b)((function(e){var t=e.firestore.ordered.users;return{username:t,lenght:t?e.firestore.ordered.users.length:null}}),(function(e){return{addMessages:function(t){return e(function(e,t,a,n){return function(r,s,l){l.getFirebase;var c=(0,l.getFirestore)(),i=s().firebase.profile,o=s().firebase.auth.uid,m=s().firestore.ordered.messages,u=!1,d=i.firstName+" "+i.lastName,h=e.message,f=e.friendId,g=e.Friend_Fullname;e.New_message=!0;for(var E=0;E<m.length;E++)m[E].friendId==f&&(u=!0);!1===u&&(c.collection("rooms").doc(o).collection("messages").add(Object(p.a)(Object(p.a)(Object(p.a)(Object(p.a)(Object(p.a)({},e),t),a),n),{},{friendFirstName:i.firstName,friendLastName:i.lastName,userId:o,CreatedAt:new Date})).then((function(){r({type:"ADD_MESSAGE",message:e})})).catch((function(e){r({type:"ADD_MESSAGE_ERROR",err:e})})),e.message=e.secondmessage+" "+i.firstName+" "+i.lastName,e.Friend_Fullname=d,e.friendId=o,c.collection("rooms").doc(f).collection("messages").add(Object(p.a)(Object(p.a)(Object(p.a)(Object(p.a)(Object(p.a)({},e),t),a),n),{},{friendFirstName:g,friendLastName:"",userId:f,CreatedAt:new Date})).then((function(){r({type:"ADD_MESSAGE",message:e})})).catch((function(e){r({type:"ADD_MESSAGE_ERROR",err:e})})),e.message=h,e.Friend_Fullname=g,e.friendId=f)}}(t))},addDetails:function(t){return e(b(t))}}}))(N),O=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,this.props.users.map((function(e){return r.a.createElement(v,{name:e})})))}}]),a}(n.Component),j=a(20),y=a(16),S=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={users:[],searchTerm:""},e.editSearchTerm=function(t){e.setState({searchTerm:t.target.value})},e.dynamicSearch=function(){return e.state.users.filter((function(t){return t.toLowerCase().includes(e.state.searchTerm.toLowerCase())}))},e}return Object(i.a)(a,[{key:"render",value:function(){for(var e=this.props,t=e.profile,a=e.username,n=e.lenght,s=0;s<n;s++){var l=a?a[s].firstName+" "+a[s].lastName:null;(a?a[s].friendId:null)!=E.a.auth().currentUser.uid&&(this.state.users[s]=l)}return r.a.createElement("div",null,r.a.createElement("ul",{className:"right"},r.a.createElement("li",null,r.a.createElement(f.Modal,{header:"Sent friend request !",trigger:r.a.createElement(f.Button,{waves:"light"},"Add Friends",r.a.createElement(f.Icon,{right:!0},"search"))},r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"fullname"},"Search for a name !"),r.a.createElement("input",{type:"text",value:this.state.searchTerm,onChange:this.editSearchTerm}),r.a.createElement(O,{users:this.dynamicSearch()})))),r.a.createElement("li",null,r.a.createElement("a",{onClick:this.props.signOut},"Log Out")),r.a.createElement("li",null,r.a.createElement(u.c,{to:"/",className:"btn btn-floating orange lighten-1"},t.initials))))}}]),a}(n.Component),F=Object(y.d)(Object(j.firestoreConnect)((function(){return["users"]})),Object(h.b)((function(e){var t=e.firestore.ordered.users,a=t?e.firestore.ordered.users.length:null;return{profile:e.firebase.profile,username:t,lenght:a}}),(function(e){return{signOut:function(){return e((function(e,t,a){(0,a.getFirebase)().auth().signOut().then((function(){e({type:"SIGNOUT_SUCCESS"})}))}))}}})))(S),I=function(){return r.a.createElement("ul",{className:"right"},r.a.createElement("li",null,r.a.createElement(u.c,{to:"/signin"},"Sign In")),r.a.createElement("li",null,r.a.createElement(u.c,{to:"/signup"},"Sign Up")))},w=Object(h.b)((function(e){return console.log(e),{auth:e.firebase.auth,profile:e.firebase.profile}}))((function(e){var t=e.auth,a=t.uid?r.a.createElement(F,null):r.a.createElement(I,null);return r.a.createElement("nav",{className:"nav-wrapper grey darken-3"},r.a.createElement("div",{className:"container"},r.a.createElement(u.b,{to:"/",className:"brand-logo"},"Chat Room"),Object(j.isLoaded)(t)&&a))})),C=function(e){E.a.auth().currentUser;return r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"card z-depth-0"},r.a.createElement("div",{className:"card-content"},r.a.createElement("span",{className:"card-title"},"Active Friends"),r.a.createElement("ul",{className:"notifications"},r.a.createElement("li",null,"No active friends")))))},A=a(32),D=a.n(A),_=function(e){var t=e.message;return t.New_message?r.a.createElement("div",{className:"card z-depth-0 message-summary"},r.a.createElement("div",{className:"card-content grey-text text-darken-3"},r.a.createElement("span",{className:"card-title"},t.Friend_Fullname),r.a.createElement("p",null,t.message),r.a.createElement("ul",null,r.a.createElement("li",{className:"right orange-text"},D()(t.CreatedAt.toDate()).calendar())))):r.a.createElement("div",{className:"card z-depth-0 message-summary"},r.a.createElement("div",{className:"card-content grey-text text-darken-3"},r.a.createElement("li",{className:"right btn btn-floating orange lighten-1"},"New"),r.a.createElement("span",{className:"card-title"},t.Friend_Fullname),r.a.createElement("p",null,t.message),r.a.createElement("ul",null,r.a.createElement("li",{className:"right orange-text"},D()(t.CreatedAt.toDate()).calendar()))))},R=function(e){var t=e.messages,a=e.requested;return r.a.createElement("div",{className:"friends-list section"},t&&t.map((function(e){return r.a.createElement(u.b,{to:"/messages/"+e.id,key:e.id},r.a.createElement(_,{message:e,requested:a}))})))},x=function(e){var t=e.notifications;return r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"card z-depth-0"},r.a.createElement("div",{className:"card-content"},r.a.createElement("span",{className:"card-title"},"Notifications"),r.a.createElement("ul",{className:"notifications"},t&&t.map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement("span",{className:"green-text"},e.user," "),r.a.createElement("span",null,e.content),r.a.createElement("div",{className:"orange-text lighten-1 note-date right"},D()(e.time.toDate()).fromNow()))}))))))},L=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.messages,a=e.auth,n=e.notifications,s=e.requested;return a.uid?t?r.a.createElement("div",{className:"dashboard container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12 m5"},r.a.createElement(R,{messages:t,requested:s})),r.a.createElement("div",{className:"col s12 m6"},r.a.createElement(x,{notifications:n})),r.a.createElement("div",{className:"col s12 m5 offset-m2"},r.a.createElement(C,null)))):r.a.createElement("div",{className:"dashboard container"},r.a.createElement("div",{className:"row right"},r.a.createElement("div",{className:"col s12 m5"},r.a.createElement(x,{notifications:n})),r.a.createElement("div",{className:"col s12 m5"},r.a.createElement(C,null)))):r.a.createElement(d.a,{to:"/signin"})}}]),a}(n.Component),k=Object(y.d)(Object(h.b)((function(e){var t=e.firebase.auth.uid;if(t)a=t;else var a="room1";return{messages:e.firestore.ordered.messages,auth:e.firebase.auth,notifications:e.firestore.ordered.notifications,userId:a,requested:e.firestore.status.requested.messages}})),Object(j.firestoreConnect)((function(e){return[{collection:"rooms",doc:e.userId,subcollections:[{collection:"messages"}],storeAs:"messages",orderBy:["CreatedAt","desc"]},{collection:"notifications",limit:5,orderBy:["time","desc"]}]})))(L),U=function(e){var t=e.detail;return t.friendLastName?r.a.createElement("div",{className:"card-panel z-depth-0 orange lighten-1"},r.a.createElement("div",{className:"card-content"},r.a.createElement("ul",null,r.a.createElement("li",{className:"right white-text bold"},r.a.createElement("p",null," ",t.message," ")),r.a.createElement("div",{className:"card action grey lighten-4 grey-text"},r.a.createElement("ul",{className:"left"},r.a.createElement("li",{className:"grey-text text-lighten-2"},D()(t.CreatedAt.toDate()).calendar()),r.a.createElement("li",null)))))):r.a.createElement("div",{className:"card-panel z-depth-0 grey lighten-3"},r.a.createElement("div",{className:"card-content"},r.a.createElement("ul",null,r.a.createElement("li",{className:"left black-text"},r.a.createElement("p",null," ",t.message," ")),r.a.createElement("div",{className:"card action grey lighten-4 grey-text"},r.a.createElement("ul",{className:"right"},r.a.createElement("li",{className:"orange-text text-lighten-1"},D()(t.CreatedAt.toDate()).calendar()),r.a.createElement("li",null))))))},G=function(e){var t=e.details;return r.a.createElement("div",{className:"messages-list section"},t&&t.map((function(e){return r.a.createElement(U,{detail:e})})))},T=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={message:"",Friend_Fullname:"",secondmessage:"",friendId:"",New_message:!1},e.handleSubmit=function(t){t.preventDefault(),e.props.addDetails(e.state),e.props.history.push("/")},e.handleChange=function(t){e.state.message=t.target.value},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.message,a=e.details,n=e.auth,s=e.friendname,l=e.userId;return n.uid?a?(this.state.Friend_Fullname=t.Friend_Fullname,this.state.secondmessage="Say Hi to your new friend ",this.state.friendId=t.friendId,r.a.createElement("div",{className:"container section messages"},r.a.createElement("div",{className:"card z-depth-0"},r.a.createElement("div",{className:"card-content"},r.a.createElement("span",{className:"card-title"},s," ")),r.a.createElement("div",{className:"card-content"},r.a.createElement(G,{details:a,userId:l})),r.a.createElement("div",{className:"card action grey lighten-4 grey-text"},r.a.createElement("form",{onSubmit:this.handleSubmit,className:"white"},r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"message"},"Enter your message here"),r.a.createElement("input",{type:"text",id:"message",onChange:this.handleChange})),r.a.createElement("div",{className:"right input-field"},r.a.createElement("button",{className:"btn purple dareken-5 z-depth-0"},"Send"))))))):r.a.createElement("div",{className:"container center white-text"},r.a.createElement("p",null,"Loading...")):r.a.createElement(d.a,{to:"/signin"})}}]),a}(n.Component),z=Object(y.d)(Object(h.b)((function(e,t){var a=t.match.params.id,n=e.firestore.data.messages,r=n?n[a]:null,s=n?r.Friend_Fullname:null,l=e.firebase.auth.uid;if(l)c=l;else var c="room1";return{message:r,details:e.firestore.ordered.details,auth:e.firebase.auth,userId:c,friendname:s}}),(function(e){return{addDetails:function(t){return e(b(t))}}})),Object(j.firestoreConnect)((function(e){return[{collection:"rooms",doc:e.userId,subcollections:[{collection:"messages",doc:e.friendname,subcollections:[{collection:"details"}]}],storeAs:"details",orderBy:["CreatedAt","asc"]}]})))(T),M=a(52),P=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={email:"",password:""},e.handleSubmit=function(t){t.preventDefault(),e.props.signIn(e.state)},e.handleChange=function(t){e.setState(Object(M.a)({},t.target.id,t.target.value))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.authError;return e.auth.uid?r.a.createElement(d.a,{to:"/"}):r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:this.handleSubmit,className:"white"},r.a.createElement("h5",{className:"black-text text-darken-3"},"Sign In"),r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{type:"email",id:"email",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field center"},r.a.createElement("button",{className:"btn orange lighten-1 z-depth-0"},"Login"),r.a.createElement("div",{className:"red-text center"},t?r.a.createElement("p",null,t):null)),r.a.createElement("div",{className:"input-field center"},r.a.createElement("p",null,"Forgot your password ?"))))}}]),a}(n.Component),B=Object(h.b)((function(e){return{authError:e.auth.authError,auth:e.firebase.auth}}),(function(e){return{signIn:function(t){return e(function(e){return function(t,a,n){(0,n.getFirebase)().auth().signInWithEmailAndPassword(e.email,e.password).then((function(){t({type:"LOGIN_SUCCESS"})})).catch((function(e){t({type:"LOGIN_ERROR"},e)}))}}(t))}}}))(P),q=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={email:"",password:"",firstName:"",lastName:"",initials:""},e.handleSubmit=function(t){t.preventDefault(),e.props.signUp(e.state)},e.handleChange=function(t){e.setState(Object(M.a)({},t.target.id,t.target.value))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.authError;return t.uid?r.a.createElement(d.a,{to:"/"}):r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:this.handleSubmit,className:"white"},r.a.createElement("h5",{className:"black-text text-lighten-4"},"Sign Up"),r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"firstName"},"First Name"),r.a.createElement("input",{type:"text",id:"firstName",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"lastName"},"Last Name"),r.a.createElement("input",{type:"text",id:"lastName",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{type:"email",id:"email",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field center"},r.a.createElement("button",{className:"btn orange lighten-1 z-depth-0"},"Sign Up"),r.a.createElement("div",{className:"red-text center"},a?r.a.createElement("p",null,a):null)),r.a.createElement("div",{className:"input-field center"},r.a.createElement(u.b,{to:"/signin/"},"Already have an account ?"))))}}]),a}(n.Component),H=Object(h.b)((function(e){return{auth:e.firebase.auth,authError:e.auth.authError}}),(function(e){return{signUp:function(t){return e(function(e){return function(t,a,n){var r=n.getFirebase,s=n.getFirestore,l=r(),c=s();l.auth().createUserWithEmailAndPassword(e.email,e.password).then((function(t){console.log(t.user.uid),c.collection("users").doc(t.user.uid).set({firstName:e.firstName,lastName:e.lastName,initials:e.firstName[0]+e.lastName[0],friendId:t.user.uid,online:!1})})).then((function(){t({type:"SIGNUP_SUCCESS"})})).catch((function(e){t({type:"SIGNUP_ERROR"},e)}))}}(t))}}}))(q),J=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(u.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(w,null),r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:k}),r.a.createElement(d.b,{path:"/messages/:id",component:z}),r.a.createElement(d.b,{path:"/signin",component:B}),r.a.createElement(d.b,{path:"/signup",component:H}))))}}]),a}(n.Component),X={authError:null},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_SUCCESS":return Object(p.a)(Object(p.a)({},e),{},{authError:null});case"LOGIN_ERROR":return Object(p.a)(Object(p.a)({},e),{},{authError:"sign in failed"});case"SIGNOUT_SUCCESS":return e;case"SIGNUP_SUCCESS":return Object(p.a)(Object(p.a)({},e),{},{authError:null});case"SIGNUP_ERROR":return Object(p.a)(Object(p.a)({},e),{},{authError:"sign up failed"});default:return e}},K={messages:[{id:"1",friend:"Haroune",content:"blah blah blah"},{id:"2",friend:"Soulaymane",content:"Have u seen the last trailer of apex legends season 7 its cool man"},{id:"3",friend:"Lina",content:"fjvkjdslfj67t3jd"}]},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD-MESSAGE":return console.log("added message",t.message),e;case"ADD_MESSAGE_ERROR":return console.log("error adding message",t.err),e;case"ADD-DETAIL":return console.log("added detail",t.message),e;case"ADD_DETAIL_ERROR":return console.log("error adding detail",t.err),e;default:return e}},V=a(53),Y=Object(y.c)({auth:W,message:Q,firestore:V.firestoreReducer,firebase:j.firebaseReducer}),Z=a(228),$=(a(459),a(462),{apiKey:"AIzaSyATHXwS9-HXlBAXMNmLInMe7r8p9wBJGBo",authDomain:"mouatamir-younes-chatroom.firebaseapp.com",databaseURL:"https://mouatamir-younes-chatroom.firebaseio.com",projectId:"mouatamir-younes-chatroom",storageBucket:"mouatamir-younes-chatroom.appspot.com",messagingSenderId:"582703011973",appId:"1:582703011973:web:4b4a701a5811f61a7171ec"});E.a.initializeApp($);var ee=$,te=Object(y.e)(Y,Object(y.d)(Object(y.a)(Z.a.withExtraArgument({getFirebase:j.getFirebase,getFirestore:V.getFirestore})),Object(V.reduxFirestore)(E.a,ee))),ae={firebase:E.a,config:{userProfile:"users",useFirestoreForProfile:!0,attachAuthIsReady:!0},dispatch:te.dispatch,createFirestoreInstance:V.createFirestoreInstance};l.a.render(r.a.createElement(h.a,{store:te},r.a.createElement(j.ReactReduxFirebaseProvider,ae,r.a.createElement(J,null))),document.getElementById("root"))}},[[229,1,2]]]);
//# sourceMappingURL=main.a9e0d821.chunk.js.map